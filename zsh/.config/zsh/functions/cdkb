#!/usr/bin/env zsh
#
# Quick navigation to Claude Code Knowledge Base
# Usage: cdkb [subdirectory]

function cdkb() {
    local kb_path="${CLAUDE_KB_PATH:-${HOME}/claude-knowledge-base}"
    local target_dir="${kb_path}"

    if [[ $# -gt 0 ]]; then
        target_dir="${kb_path}/${1}"
    fi

    if [[ ! -d "${target_dir}" ]]; then
        echo "Knowledge base not found at: ${target_dir}"
        echo "Run 'setup-knowledge-base' to initialize"
        return 1
    fi

    cd "${target_dir}" || return 1
    echo "ðŸ“š Knowledge Base: $(pwd)"

    # Show recent files if in root
    if [[ "${target_dir}" == "${kb_path}" ]]; then
        echo ""
        echo "Recent additions:"
        find . -name "*.md" -not -path "./.*" -type f -print0 | \
            xargs -0 ls -t | head -5 | \
            sed 's|^\./||' | \
            while read -r file; do
                echo "  ${file}"
            done
    fi
}
